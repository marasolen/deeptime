/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/public-google-sheets-parser@1.3.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function asyncGeneratorStep(e,t,s,r,n,o,a){try{var i=e[o](a),l=i.value}catch(e){return void s(e)}i.done?t(l):Promise.resolve(l).then(r,n)}function _asyncToGenerator(e){return function(){var t=this,s=arguments;return new Promise((function(r,n){var o=e.apply(t,s);function a(e){asyncGeneratorStep(o,r,n,a,i,"next",e)}function i(e){asyncGeneratorStep(o,r,n,a,i,"throw",e)}a(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}const isBrowser="undefined"==typeof require,fetch=isBrowser?window.fetch:require("../src/fetch");let PublicGoogleSheetsParser=function(){function e(t,s){_classCallCheck(this,e),this.id=t,this.parseSheetInfo(s)}var t;return _createClass(e,[{key:"parseSheetInfo",value:function(e){e&&("string"==typeof e?(this.sheetName=e,this.sheetId=null):"object"==typeof e&&(this.sheetName=e.sheetName,this.sheetId=e.sheetId))}},{key:"getSpreadsheetDataUsingFetch",value:function(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;return this.sheetId?e=e.concat(`gid=${this.sheetId}`):this.sheetName&&(e=e.concat(`sheet=${this.sheetName}`)),fetch(e).then((e=>e&&e.ok&&e.text?e.text():null)).catch((e=>null))}},{key:"normalizeRow",value:function(e){return e.map((e=>e&&null!==e.v&&void 0!==e.v?e:{}))}},{key:"applyHeaderIntoRows",value:function(e,t){return t.map((({c:e})=>this.normalizeRow(e))).map((t=>t.reduce(((t,s,r)=>s.v?Object.assign(t,{[e[r]]:s.v}):t),{})))}},{key:"getItems",value:function(e){let t=[];try{const s=JSON.parse(e.split("\n")[1].replace(/google.visualization.Query.setResponse\(|\);/g,""));if(s.table.cols.some((({label:e})=>!!e))){const e=s.table.cols.map((({label:e})=>e));t=this.applyHeaderIntoRows(e,s.table.rows)}else{const[e,...r]=s.table.rows,n=this.normalizeRow(e.c).map((e=>e.v));t=this.applyHeaderIntoRows(n,r)}}catch(e){}return t}},{key:"parse",value:(t=_asyncToGenerator((function*(e,t){if(e&&(this.id=e),t&&this.parseSheetInfo(t),!this.id)throw new Error("SpreadsheetId is required.");const s=yield this.getSpreadsheetDataUsingFetch();return null===s?[]:this.getItems(s)})),function(e,s){return t.apply(this,arguments)})}]),e}();isBrowser?window.PublicGoogleSheetsParser=PublicGoogleSheetsParser:(module.exports=PublicGoogleSheetsParser,module.exports.default=PublicGoogleSheetsParser);
//# sourceMappingURL=/sm/cd9844bc8399f34d5812a5e556a437660968fb144f38fa6f9c23a7b8c1024339.map